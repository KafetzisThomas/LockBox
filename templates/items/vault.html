{% extends "layout.html" %}

{% block title %}My Vault{% endblock title %}

{% block content %}
    <div class="mb-4 d-flex flex-column gap-2">
        <input id="searchInput" class="form-control form-control-sm" type="search" placeholder="Search items..." onkeyup="filterItems()">
        <button class="btn btn-sm btn-primary w-100 py-2 fw-bold" type="button" data-bs-toggle="modal" data-bs-target="#createModal">
            <i class="bi bi-plus-lg me-1"></i> New Item
        </button>
    </div>

    <p id="message" class="text-center"></p>

    <div id="vaultList" class="d-flex flex-column gap-3"></div>

    <div id="emptyState" class="container text-center mt-3 d-none">
        <h5 class="text-muted">There are no items in the list.</h5>
    </div>

    <div class="modal fade" id="createModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow">
                <form id="createForm">
                    <div class="modal-header">
                        <h5 class="modal-title fw-bold">New Item</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="newName" class="form-label">Name</label>
                            <input type="text" id="newName" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label for="newUsername" class="form-label">Username / Email</label>
                            <input type="text" id="newUsername" class="form-control">
                        </div>

                        <div class="mb-3">
                            <label for="newPassword" class="form-label">Password</label>
                            <div class="input-group">
                                <input type="text" id="newPassword" class="form-control">
                                <button type="button" class="btn btn-outline-secondary" onclick="fillPasswordField('newPassword')"><i class="bi bi-magic"></i></button>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="newWebsite" class="form-label">Website</label>
                            <input type="text" id="newWebsite" class="form-control" placeholder="e.g. google.com">
                        </div>

                        <div class="mb-3">
                            <label for="newNotes" class="form-label">Notes</label>
                            <textarea id="newNotes" class="form-control" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary w-100">Save Item</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow">
                <form id="editForm">
                    <div class="modal-header">
                        <h5 class="modal-title fw-bold">Edit Item</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" id="editId">

                        <div class="mb-3">
                            <label for="editName" class="form-label">Name</label>
                            <input type="text" id="editName" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label for="editUsername" class="form-label">Username</label>
                            <div class="input-group">
                                <input type="text" id="editUsername" class="form-control">
                                <button type="button" class="btn btn-outline-secondary" onclick="copyToClipboard('editUsername')"><i class="bi bi-clipboard"></i></button>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editPassword" class="form-label">Password</label>
                            <div class="input-group">
                                <input type="text" id="editPassword" class="form-control">
                                <button type="button" class="btn btn-outline-secondary" onclick="copyToClipboard('editPassword')"><i class="bi bi-clipboard"></i></button>
                                <button type="button" class="btn btn-outline-secondary" onclick="fillPasswordField('editPassword')"><i class="bi bi-magic"></i></button>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editWebsite" class="form-label">Website</label>
                            <div class="input-group">
                                <input type="text" id="editWebsite" class="form-control" placeholder="e.g. google.com">
                                <a id="editWebsiteLink" href="#" target="_blank" class="btn btn-outline-secondary"><i class="bi bi-box-arrow-up-right"></i></a>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editNotes" class="form-label">Notes</label>
                            <textarea id="editNotes" class="form-control" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer d-flex gap-2">
                        <button type="button" class="btn btn-danger flex-fill" onclick="deleteItem()">Delete</button>
                        <button type="submit" class="btn btn-success flex-fill">Update</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock content %}

{% block scripts %}
    <script src="/static/js/main.js"></script>
    <script src="/static/js/vault.js"></script>
{% endblock scripts %}
